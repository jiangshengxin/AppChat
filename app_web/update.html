<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<link rel="stylesheet" href="./css/update.css">
	<style>
		body{
			padding:0;
			margin:0;
		}
	</style>
</head>
<body>
	<script type="text/javascript" src='js/jquery.3.1.js' ></script>
	<div id = 'update' >
		<div id='u-top' >
			<div style='-webkit-tap-highlight-color:rgba(0,0,0,0)' onclick='window.location.href="./message.html"' >
				<img src="./icon/jt.png" alt="">
				<span>返回</span>
			</div>
			<div>编辑资料</div>
		</div>
		<form action="" method='post'>
			<div id='u-head' >
				<div id="user_photo">
					<input id='photo_inp' type="file" name='photo' style='opacity:0;' />
					<img src="" alt="">
				</div>
				<div>点击修改您的头像</div>
			</div>
			<div id='u-autograph' >
				<div>签名</div>
				<textarea name="" id="" ></textarea>
			</div>
			<div id='u-nickname' >
				<div>昵称</div>
				<input type="text">
			</div>
			<div id='u-sex' >
				<div>性别</div>
				<select name="" id="">
					<option value="">男</option>
					<option value="">女</option>
				</select>
			</div>
			<div id='u-birthday' >
				<div>生日</div>
				<select id='year' name="" id="">
				</select>
				<select id='month' name="" id="">
				</select>
				<select id='day' name="" id="">
				</select>
				<script type='text/javascript' src='./js/birthday.js' ></script>
			</div>
			<div id='u-occupation' >
				<div>职业</div>
				<input type="text">
			</div>
			<div id='u-company' >
				<div>公司</div>
				<input type="text">
			</div>
			<div id='u-scholl' >
				<div>学校</div>
				<input type="text">
			</div>
			<div id='u-location' >
				<div>所在地</div>
				<input style='margin-left:25px' type="text">
			</div>
			<div id='u-hometown' >
				<div>家乡</div>
				<input type="text">
			</div>
			<div id='u-email' >
				<div>邮箱</div>
				<input type="email">
			</div>
		</form>
	</div>
	<script type="text/javascript">

		var fr = new FileReader();

		$('#photo_inp').bind('change',function(){

			fr.readAsDataURL(this.files[0]);
			fr.onload=function(){
				var img_base64=this.result;

				//预览图
				$('<img></img>').appendTo($('body')).css({
					width:'95%',
					position:'absolute',
					top:'25px',
					left:'2.5%',
					zIndex:'102'
				}).attr('src',img_base64).attr('id','yl');

				//遮罩层
				var overfull=$('<div></div>').appendTo($('body')).css({
					width:'100%',
					height:'100%',
					backgroundColor:'rgba(0,0,0,1)',
					position:'absolute',
					zIndex:'101',
					left:'0px',
					top:'0px'
				}).attr('id','overfull');

				//body宽度高度
				var pw = $('body').width();
				var ph = $(window).height();

				//选择框
				$('<div></div>').appendTo($('body')).css({
					width:pw*0.6+'px',
					height:pw*0.6+'px',
					border:'1px solid #ccc',
					position:'absolute',
					left:(pw-pw*0.6)/2+'px',
					top:(ph-pw*0.6)/2-20+'px',
					zIndex:'103',
					borderRadius:'200px',
					pointerEvents:'none' //鼠标穿透样式
				}).attr('id','selectk');

				//禁止滑动滑条
				document.addEventListener('touchmove',function(e){
					e.preventDefault();
					e.stopProPagation();
				});


				// 计算出手指滑动的距离
				var ly = document.getElementById('yl');
				alert(yl);
				yl.addEventListener('touchstart',function(e){


					// var str = '';
					// e=e['touches'][0];
					// for(var o = null in e){
					// 	str+=o+'------'+e[o]+'<br>'
					// }

					// layer X --> 未知 可代表手指所在位置？
					// layer Y --> 同上

					// touches --> 手指触摸属性 --》object
					// touches.length - 代表触摸的手指数量
					// touches.0
					// touches.1
					// .... -> 代表每个手指的对象属性
						// 每个手指对象 所包含的属性如下
							// target --> 自己理解
							// identifier --> 未知
							// clientX ---> 相较于X的位置
							// clientY ---> 相较于Y的位置
							// pageX --> ??? 其值和clientX一样
							// pageY --> ??? 其值和clientX一样
							// screenX ---> 其值一样 
							// screenY ---> 其值一样 
								// 注（以上属性可以直接计算 无px后缀）
							// radiusX ----> 数值型 后面一大堆小数点 未知
							// radiusY ----> 数值型 后面一大堆小数点 未知
							// rotationAngle ---》 未知 猜测可能是手指旋转的角度？
							// force ---- 0 未知 force 代表触摸的力度？？？what 
							// touchType ---> 代表是手指直接触摸
							// altitudeAngle ---> 应该是什么东西的角度
							// azimuthAngle ---> 应该是什么东西的角度



					var fingerPArr=[];
					for(var i = 0;i<e.touches.length;i++){
						fingerPArr[fingerPArr.length] = {x:e.touches[i].clientX,y:e.touches[i].clientY};
					}


					//如果是多个手指 计算出1手指 和 2手指之间的直线距离 - 通过勾股定理
					if(fingerPArr.length>1){

						//绝对值计算出 两个手指之间的X位置与Y位置
						var xjl = Math.abs(fingerPArr[0].x - fingerPArr[1].x);
						var yjl = Math.abs(fingerPArr[0].y - fingerPArr[1].y);

						//求第三条边 也就是两个手指头之间的距离
						var jl = Math.sqrt(Math.pow(xjl,2) + Math.pow(yjl,2));

					}


					// 调试代码
					// $('<div><div>').appendTo('body').css({
					// 	width:'100%',
					// 	height:'100%',
					// 	backgroundColor:'white',
					// 	position:'absolute',
					// 	left:'0px',top:'0px',
					// 	zIndex:'200'
					// }).html(str);
	

					yl.ontouchmove=function(e){

						//如果移动的手指数量大于1
						if(e.touches.length>1){

							var isXSame = false; // 代表 所有手指的X位置比之前大还是比之前小
							var isYSame = false; // 代表 所有手指的y位置比之前打还是比之前小

							var isXsames = []; //代表每个手指的x位置比之前大还是比之前小
							var isYsames = []; //代表每个手指的y位置比之前大还是比之前小

							//循环判断 每个手指的位置是否比之前的位置大
							for(var k = 0; k<e.touches.length;k++){
								if(e.touches[k].clientX > fingerPArr[k].x){
									isXsames[isXsames.length] = true;
								}else{
									isXsames[isXsames.length] = false;
								}
								if(e.touches[k].clientY > fingerPArr[k].y){
									isYsames[isYsames.length] = true;
								}else{
									isYsames[isYsames.length] = false;
								}
							}

							isXsame = isXsames[0] == isXsames[1] ? true : false;
							isYsame = isYsames[0] == isYsames[1] ? true : false;

							// 两个手指的X位置是否相同 && 两个手指的Y位置是否相同
							if(isXsame && isYsame){
								var moveX = parseInt(e.layerX) - fingerPArr[0].x; //计算出移动的X位置
								var moveY = parseInt(e.layerY) - fingerPArr[0].y; //计算出移动的Y位置
								$(this).css({
									left:parseInt($(this).css('left')) + moveX + 'px',
									top:parseInt($(this).css('top')) + moveY + 'px'
								});
							}

							//计算出两个手指间的距离
							var nxjl = Math.abs(e.touches[0].clientX - e.touches[1].clientX);
							var nyjl = Math.abs(e.touches[0].clientY - e.touches[1].clientY);
							var njl = Math.sqrt( Math.pow(nxjl,2) + Math.pow(nyjl,2) );

							//获取对之前线的对比
							var dbjl = Math.round(njl - jl);



							// if(isYsame){

							// }else{

							// }


							// for(var i = 0;i<fingerPArr.length;i++){

							// 	var moveX = parseInt(e.layerX) - fingerPArr[i].x; //计算出移动的X位置
							// 	var moveY = parseInt(e.layerY) - fingerPArr[i].y; //计算出移动的Y位置

							// 	$(this).css({
							// 		left:parseInt($(this).css('left')) + moveX + 'px',
							// 		top:parseInt($(this).css('top')) + moveY + 'px'
							// 	});

							// }

						}else{

							var moveX = parseInt(e.touches[0].clientX) - fingerPArr[0].x; //计算出移动的X位置
							var moveY = parseInt(e.touches[0].clientY) - fingerPArr[0].y; //计算出移动的Y位置


							$(this).css({
								left:parseInt($(this).css('left')) + moveX/15 + 'px',
								top:parseInt($(this).css('top')) + moveY/15 + 'px'
							});


						}




						// for(var i = 0;i<fingerPArr.length;i++){

						// 	var moveX = parseInt(e.layerX) - fingerPArr[i].x; //计算出移动的X位置
						// 	var moveY = parseInt(e.layerY) - fingerPArr[i].y; //计算出移动的Y位置

						// 	$(this).css({
						// 		left:parseInt($(this).css('left')) + moveX + 'px',
						// 		top:parseInt($(this).css('top')) + moveY + 'px'
						// 	});

						// }


						this.ontouchend=function(e){
							fingerPositionArr = [];
							obj = {};
						}

						// $(window).scrollTop(0);
						e.preventDefault();


					}
				});

			}

			

		});

	</script>
</body>
</html>